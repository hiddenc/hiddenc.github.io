<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>IFE JavaScript Task 01 & 02 & 03</title>
</head>
<body>
<!--<label>请输入北京今天空气质量：<input id="aqi-input" type="text"></label>
<button id="button">确认填写</button>

<div>您输入的值是：<span id="aqi-display">尚无录入</span></div>

<script>

    var $ = function (id) {
        return document.getElementById(id);
    }
    var handler = function () {
        var number = parseInt($('aqi-input').value);
        if ((!isNaN(number)) && (number >= 0) && (number <= 100)) {
            $('aqi-display').innerHTML = number;
        } else {
            alert($('aqi-input').value + " 不是有效的AQI数值，请重新输入0-1000的有效整数")
        }
    }
    $('button').onclick = function () {
        handler();
    }
    $('aqi-input').onkeyup = function (event) {
        if (event.keyCode === 13) {
            handler();
        }
    }

</script>-->



<!--<h3>污染城市列表</h3>
<ul id="aqi-list">
    &lt;!&ndash;
        <li>第一名：福州（样例），10</li>
          <li>第二名：福州（样例），10</li> &ndash;&gt;
</ul>

<script type="text/javascript">

    var aqiData = [
        ["北京", 90],
        ["上海", 50],
        ["福州", 10],
        ["广州", 50],
        ["成都", 90],
        ["西安", 100],
        ["成都", 90],
        ["西安", 100],
        ["成都", 90],
        ["西安", 100]
    ];

    (function () {

        /*
         在注释下方编写代码
         遍历读取aqiData中各个城市的数据
         将空气质量指数大于60的城市显示到aqi-list的列表中
         */
        aqiData.sort(function(a,b){
            return b[1] - a[1];
        });
        console.log(aqiData);
        var i= 0,arr = '';
        for(;i<aqiData.length;i++){
            if(aqiData[i][1]>60){
                arr+="<li>"+aqiData[i][0]+','+aqiData[i][1]+"</li>"
            }
        }
        document.getElementById('aqi-list').innerHTML = arr;


    })();

</script>-->

<ul id="source">
    <li>北京空气质量：<b>90</b></li>
    <li>上海空气质量：<b>70</b></li>
    <li>天津空气质量：<b>80</b></li>
    <li>广州空气质量：<b>50</b></li>
    <li>深圳空气质量：<b>40</b></li>
    <li>福州空气质量：<b>32</b></li>
    <li>成都空气质量：<b>90</b></li>
</ul>
<ul id="resort">
    <!--
    <li>第一名：北京空气质量：<b>90</b></li>
    <li>第二名：北京空气质量：<b>90</b></li>
    <li>第三名：北京空气质量：<b>90</b></li>
     -->

</ul>

<button id="sort-btn">排序</button>

<script type="text/javascript">

    /**
     * getData方法
     * 读取id为source的列表，获取其中城市名字及城市对应的空气质量
     * 返回一个数组，格式见函数中示例
     */
    var $ = function(id){
        return document.getElementById(id);
    };
    function getData() {
        /*
         coding here
         */
        var ul = $('source');
        var data = [];
        for(var i = 0;i<ul.childElementCount;i++){
                var li = ul.children[i];
                var strCity = li.innerHTML.split('空气质量：')[0];
                var num = Number(li.children[0].innerHTML);
                data.push([strCity,num]);
        }
        /*
         data = [
         ["北京", 90],
         ["北京", 90]
         ……
         ]
         */
        return data;

    }

    /**
     * sortAqiData
     * 按空气质量对data进行从小到大的排序
     * 返回一个排序后的数组
     */
    function sortAqiData(data) {
        data.sort(function(a,b){
            return a[1] - b[1];
        });
        return data;
    }

    /**
     * render
     * 将排好序的城市及空气质量指数，输出显示到id位resort的列表中
     * 格式见ul中的注释的部分
     */
    function render(data) {
        //<li>第一名：北京空气质量：<b>90</b></li>
        var rank = ['一','二','三','四','五','六','七','八','九','十'];
        var ul = $('resort');
        var content = '';
        for(var i = 0;i < data.length;i++){
            var aqiData = data[i];
            content+= '<li>第' + rank[i] + '名:' + aqiData[0] +'空气质量：' + '<b>' + aqiData[1] +'</b></li>';
        }
        ul.innerHTML = content;
    }

    function btnHandle() {
        var aqiData = getData();
        aqiData = sortAqiData(aqiData);
        render(aqiData);
    }


    function init() {

        // 在这下面给sort-btn绑定一个点击事件，点击时触发btnHandle函数
        $("sort-btn").onclick = function(){
            btnHandle();
        }
    }

    init();

</script>
</body>
</html>